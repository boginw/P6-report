\section{Feature 132}
The feature was described as "As a user, I would like to be able to switch between guardian and citizen mode so that I can only access the parts of the system that I should be able to" alongside the description \gls{PO} had set two requirements:

\begin{itemize}
  \item The system stores whether the user is currently in citizen or guardian mode
  \item A guardian can see the add new activities function, but a citizen cannot
\end{itemize}

We started by adding a stream to the Weekplan \gls{bloc} that contain information about whether the current mode is citizen or guardian mode. We used the stream in a Streambuilder in the Weekplan screen, and made the button visibility dependent on the state emitted from the stream.

We added an icon to the app bar. In guardian mode it is a "change to citizen" icon, and in citizen mode it is a "change to guardian" icon. The user can change mode by clicking on the proper icon.

\begin{figure}[h]
    \centering
    \includegraphics[width=0.8\textwidth]{figures/feature_132.pdf}
    \caption{A illustration of the final result after implementing feature 132}
    \label{fig:feature132}
\end{figure}

There were already a dialog box asking for af password appearing when the change to guardian icon was clicked. There was no mention of an "are you sure" dialog box when changing to citizen in the user story, but we thought that is would be an improvement to the feature, so we implemented it after asking for permission from \gls{PO} .

While we developed the feature, other guardian-only-functionality were introduced into the product, and our feature had to handle the availability of those functionalities also. Accommodating the new functionalities lead us to believe that placing the responsibility of managing whether a user is guardian or citizen did not belong to the weekplan \gls{bloc} but rather the authentication \gls{bloc}. Therefore we moved it and again used the Flutter stream-builder widget to handle the rendering of the screen.

All in all, the implementation allows developers to use a stream builder widget and in there do an if-else statement to handle functionality for the citizen mode and guardian mode, which offers a clean and comprehensive way to handle the restriction of features.
